/* ============================================================
   STORYTELLING LAYOUT - COMPACT & ALIGNED
   ============================================================ */

/* 1. Reset des hauteurs et espaces inter-sections */
.chapter { 
    padding: 20px 0 !important; /* Réduit l'espace entre les blocs */
    display: block;
}

.chapter .container {
    max-width: 1200px !important; /* Verrouille l'alignement global */
    width: 100% !important;
    min-height: auto !important; /* Supprime le vide vertical (100vh) */
    justify-content: flex-start !important;
    padding-top: 0 !important;
    padding-bottom: 0 !important;
    margin: 0 auto !important;
}

/* 2. Fix spécifique Vue 2 (Split-View 45/55) sans débordement */
.split-view .container {
    display: flex !important;
    flex-direction: row;
    align-items: flex-start;
    gap: var(--space-32);
    box-sizing: border-box !important;
}

.content-side { 
    flex: 0 0 40% !important; 
    padding: var(--space-24) !important; 
    background: var(--color-bg-secondary); 
    border-radius: var(--radius-md);
    box-sizing: border-box !important;
}

.viz-side { 
    flex: 0 0 60% !important;
    min-width: 0; /* Empêche D3 de pousser les murs */
    box-sizing: border-box !important;
}

.sticky-text { 
    position: sticky; 
    top: 40px; 
}

/* 3. Ajustement des textes et headers pour éviter les trous */
header { margin: 0 0 var(--space-12) 0 !important; }

.header-bar { justify-content: center; }
.header-title { text-align: center; margin: 0 !important; }

h1, h2, h3 { 
    margin-top: 0 !important; 
    margin-bottom: var(--space-8) !important;
    line-height: 1.1 !important; 
}

/* 4. Fixes techniques Visualisation (D3.js) */
#map-holder, #climate-map-holder, #energy-map-holder, #water-volume-bar-holder {
    width: 100%;
    min-height: 550px;
    display: block;
}

svg { width: 100% !important; height: auto !important; }

/* 5. Style Maître du Tooltip (Centralisé) */
.tooltip {
    position: absolute !important;
    z-index: 100000 !important; 
    opacity: 0; 
    pointer-events: none !important;
    background: var(--color-bg-tertiary) !important;
    color: var(--color-text-primary) !important;
    padding: var(--space-12) !important;
    border: 1px solid var(--color-accent) !important;
    border-radius: var(--radius-sm) !important;
    box-shadow: var(--shadow-lg) !important;
    font-size: var(--font-size-sm) !important;
    transition: opacity 0.1s ease-out !important;
}

/* 6. Harmonisation des couleurs graphiques */
svg text { fill: var(--color-text-primary) !important; }
.axis text, .tick text, .legend text { fill: var(--color-text-secondary) !important; }
.axis line, .axis path, .domain { stroke: var(--color-text-muted) !important; }

/* 7. Controls & Dashboards compacts */
.control-group.dashboard-card {
    width: 25%;
    min-width: 280px;
    margin: 10px auto !important;
}